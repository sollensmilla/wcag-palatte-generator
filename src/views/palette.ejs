<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Your WCAG Palette</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://use.typekit.net/hiy5ivd.css">
    <link rel="stylesheet" href="/style.css" />
    <script src="/js/flash-script.js" defer></script>
</head>

<body>
    <main>
        <% if (flash.error && flash.error.length> 0) { %>
            <% flash.error.forEach(msg=> { %>
                <div class="alert alert-danger">
                    <%= msg %>
                </div>
                <% }) %>
                    <% } %>

                        <% if (flash.success && flash.success.length> 0) { %>
                            <% flash.success.forEach(msg=> { %>
                                <div class="alert alert-success">
                                    <%= msg %>
                                </div>
                                <% }) %>
                                    <% } %>


                                        <h1>Your WCAG Color Palette</h1>

                                        <div class="palette-card">
                                            <div class="palette-header">
                                                <h2 class="palette-title"> Palette Results</h2>
                                            </div>

                                            <div class="color-row">
                                                <% Object.entries(palette).forEach(([name, color])=> {
                                                    const isLighter = name.toLowerCase().includes('lighter');
                                                    const textColor = isLighter ? '#000' : '#fff';
                                                    %>
                                                    <div class="color-box"
                                                        style="background-color: <%= color %>; color: <%= textColor %>;">
                                                        <p>
                                                            <%= name %>
                                                        </p>
                                                        <p>
                                                            <%= color %>
                                                        </p>
                                                    </div>
                                                    <% }) %>
                                            </div>

                                            <div class="palette-info">
                                                <p><strong>Base color:</strong>
                                                    <%= basecolor %>
                                                </p>
                                                <p><strong>WCAG level:</strong>
                                                    <%= level %>
                                                </p>
                                                <p><strong>Large text:</strong>
                                                    <%= isLargeText ? 'Yes' : 'No' %>
                                                </p>
                                            </div>
                                        </div>

                                        <div class="example-row" style="background-color: <%= basecolor %>;">
                                            <% Object.entries(palette).forEach(([name, color])=> {
                                                if (name.toLowerCase() !== 'base') {
                                                %>
                                                <div class="example-color" style="color: <%= color %>;">
                                                    <%= name %> (<%= color %>)
                                                </div>
                                                <% } }); %>
                                        </div>


                                        <form action="/palette/save" method="POST">
                                            <label for="name">Palette Name:</label>
                                            <input type="text" id="name" name="name" placeholder="My Palette"
                                                required />

                                            <input type="hidden" name="basecolor" value="<%= basecolor %>">
                                            <input type="hidden" name="colors" value='<%= JSON.stringify(palette) %>'>
                                            <input type="hidden" name="level" value="<%= level %>">
                                            <input type="hidden" name="isLargeText" value="<%= isLargeText %>">

                                            <button type="submit" class="btn save">Save Palette</button>
                                        </form>

                                        <div class="button-row">
                                            <a href="/" class="btn generate">Generate a new palette</a>
                                            <form action="/palette" method="GET" style="display:inline;">
                                                <button type="submit" class="btn generate">Show Saved Palettes</button>
                                            </form>
                                        </div>

    </main>
</body>

</html>